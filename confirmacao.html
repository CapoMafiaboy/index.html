<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Confirmação do Pedido - XBRI</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet" />
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background-color: #f4f4f4;
      margin: 0;
      color: #333;
    }

    header {
      background: #fff;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 15px 40px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    header h1 {
      color: #d60000;
      font-size: 22px;
      margin: 0;
    }

    .container {
      max-width: 900px;
      margin: 40px auto;
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 3px 8px rgba(0,0,0,0.1);
      padding: 30px 40px;
    }

    h2 {
      text-align: center;
      font-size: 24px;
      color: #222;
    }

    .info-box {
      background: #f9f9f9;
      border-left: 5px solid #008b2f;
      padding: 20px;
      border-radius: 6px;
      margin-bottom: 25px;
    }

    .info-box strong {
      color: #008b2f;
    }

    .section-title {
      font-weight: 700;
      font-size: 18px;
      margin-top: 20px;
      color: #222;
    }

    .dados, .pedido {
      background: #f9f9f9;
      padding: 20px;
      border-radius: 6px;
      margin-top: 10px;
    }

    .dados p, .pedido p {
      margin: 6px 0;
      font-size: 14px;
    }

    .pedido-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-bottom: 1px solid #ddd;
      padding: 10px 0;
    }

    .pedido-item img {
      width: 80px;
      height: auto;
      border-radius: 6px;
    }

    .pedido-item .info {
      flex: 1;
      margin-left: 15px;
    }

    .pedido-item .info h4 {
      margin: 0;
      font-size: 15px;
    }

    .total {
      font-size: 18px;
      text-align: right;
      margin-top: 15px;
      font-weight: 700;
    }

    .btn-whatsapp {
      display: block;
      background: #008b2f;
      color: #fff;
      text-align: center;
      font-weight: 700;
      border: none;
      border-radius: 6px;
      padding: 14px;
      text-decoration: none;
      font-size: 16px;
      margin-top: 25px;
      transition: background 0.3s;
    }

    .btn-whatsapp:hover {
      background: #00a63a;
    }

    footer {
      background: #111;
      color: #eee;
      text-align: center;
      padding: 15px 0;
      margin-top: 50px;
      font-size: 14px;
    }
  </style>
</head>
<body>

  <header>
    <h1>XBRI</h1>
    <span><strong>Confirmação do Pedido</strong></span>
  </header>

  <div class="container">
    <div class="info-box">
      <p><strong>Estamos quase lá! 🚚</strong><br>
      Para que o pagamento seja realizado com segurança na entrega, você precisa <strong>baixar o aplicativo da transportadora</strong>.<br><br>
      É por lá que você vai <strong>confirmar sua titularidade</strong>, <strong>gerar o código de rastreio</strong>, <strong>acompanhar o trajeto do pedido em tempo real</strong> e <strong>receber o QR Code de entrega</strong> — que será escaneado pelo motorista no momento da entrega.<br><br>
      Toque abaixo para <strong>confirmar seu pedido e receber as instruções no WhatsApp</strong>:</p>
    </div>

    <h2>Resumo do Pedido</h2>

    <div class="pedido" id="pedidoResumo"></div>

    <h2>Dados do Cliente</h2>
    <div class="dados" id="dadosCliente"></div>

    <a id="btnWhats" href="#" class="btn-whatsapp" target="_blank">
      CONFIRMAR PEDIDO NO WHATSAPP
    </a>
  </div>

  <footer>
    © 2025 XBRI Pneus - Todos os direitos reservados
  </footer>

  <script>
    // Pega dados do cliente e do carrinho
    const cliente = JSON.parse(localStorage.getItem("dadosCliente"));
    const carrinho = JSON.parse(localStorage.getItem("carrinho")) || [];

    // Se estiver vazio, redireciona pra index
    if (!cliente || carrinho.length === 0) {
      window.location.href = "index.html";
    }

    // Exibe dados do cliente
    document.getElementById("dadosCliente").innerHTML = `
      <p><strong>Nome:</strong> ${cliente.nome} ${cliente.sobrenome}</p>
      <p><strong>Telefone:</strong> ${cliente.telefone}</p>
      <p><strong>Cidade:</strong> ${cliente.cidade}</p>
      <p><strong>Estado:</strong> ${cliente.estado}</p>
      <p><strong>CEP:</strong> ${cliente.cep}</p>
      <p><strong>Endereço:</strong> ${cliente.endereco}</p>
    `;

    // Exibe os produtos do carrinho
    const pedidoDiv = document.getElementById("pedidoResumo");
    let total = 0;

    carrinho.forEach(produto => {
      const subtotal = produto.price * produto.quantity;
      total += subtotal;

      const itemHTML = `
        <div class="pedido-item">
          <img src="${produto.image}" alt="${produto.name}">
          <div class="info">
            <h4>${produto.name}</h4>
            <p>Quantidade: ${produto.quantity}</p>
            <p>Valor unitário: R$ ${produto.price.toFixed(2)}</p>
          </div>
          <p><strong>R$ ${subtotal.toFixed(2)}</strong></p>
        </div>
      `;
      pedidoDiv.insertAdjacentHTML("beforeend", itemHTML);
    });

    pedidoDiv.insertAdjacentHTML("beforeend", `
      <p class="total">Total do pedido: <strong>R$ ${total.toFixed(2)}</strong></p>
    `);

    // Gera mensagem pro WhatsApp
    const mensagem = encodeURIComponent(
      `🚚 *Confirmação de Pedido XBRI*\n\n` +
      `👤 *Cliente:* ${cliente.nome} ${cliente.sobrenome}\n📞 *Telefone:* ${cliente.telefone}\n🏙️ *Cidade:* ${cliente.cidade}/${cliente.estado}\n🏠 *Endereço:* ${cliente.endereco}\n📦 *CEP:* ${cliente.cep}\n\n` +
      `🛞 *Itens do Pedido:*\n` +
      carrinho.map(p => `- ${p.name} (Qtd: ${p.quantity}) — R$ ${(p.price * p.quantity).toFixed(2)}`).join("\n") +
      `\n\n💰 *Total:* R$ ${total.toFixed(2)}\n\n✅ Desejo confirmar meu pedido e receber as instruções da entrega.`
    );

    document.getElementById("btnWhats").href = `https://wa.me/5511921905799?text=${mensagem}`;
  </script>

</body>
</html>
